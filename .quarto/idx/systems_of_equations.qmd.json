{"title":"Systems of equations","markdown":{"yaml":{"title":"Systems of equations","execute":{"echo":false}},"headingText":"Matrix-vector notation for a system","containsRefs":false,"markdown":"\n\nLets review the method you use in high-school to solve systems of equations - *the elimination method* - and then rewrite it under a new notation - the matrix and vector notation.\n\nA few examples will be given.\n\nKey concepts: *systems of equations in matrix-vector notation, elimination, pivot, rank, conditions for 1,0 or infinite solutions.*\n\n\n::: {.callout-tip appearance=\"simple\"}\n## Video\n\n[Translating between notation](https://youtu.be/Q2Q74yG5kQU){target=\"_blank\"}\n:::\n\nConsider the system with two equations, called $l_1$ and $l_2$:\n\n$$\n\\begin{cases}\nx-4y =2\\\\\n2x-6y = 5\n\\end{cases}\n$$ {#eq-sist}\n\nIn @eq-sist we find two equations and two unknowns $x$ and $y$. We want their values such that both equations are satisfied. (this system represents the interception of two lines)\n\nUsing the matrix-vector notation we can write @eq-sist as:\n\n$$\n\\begin{pmatrix} 1 & -4\\\\ 2 & -6 \\end{pmatrix}\\begin{pmatrix}x\\\\y\\end{pmatrix}= \\begin{pmatrix}2\\\\5\\end{pmatrix}\n$$ {#eq-matrix_sist}\n\nLets read @eq-matrix_sist in words: the $2$ by $2$ matrix of coefficients is multiplied by the column vector $\\begin{pmatrix}x\\\\y\\end{pmatrix}$ , the result is $\\begin{pmatrix}2\\\\5\\end{pmatrix}$. This is *one* equation with *one* unknown, the column vector $\\begin{pmatrix}x\\\\y\\end{pmatrix}$. Traditionally we write @eq-matrix_sist as $A \\mathbf{x} =\\mathbf{b}$.\n\nHow do we multiply a vector by a matrix?\n\n*Answer:*\n\n$$\n\\overbrace{\\begin{pmatrix} 1 & -4\\\\ 2 & -6 \\end{pmatrix}\\begin{pmatrix}x\\\\y\\end{pmatrix}}^\\text{matrix-vector mult.} =\\overbrace{\\begin{pmatrix}1\\cdot x-4\\cdot y \\\\ 2\\cdot x-6\\cdot y\\end{pmatrix}}^\\text{scalar mult.}\n$$\n\nMatrix times a vector on the lhs is just a super-compact way of writing the vector on the rhs. Moreover, notice the shapes of the matrix and vectors, this is very, very important. A $2$ by $2$ matrix times a $2$ by $1$ column vector yields a $2$ by $1$ column vector! If you understand this it should not be a problem to see what shapes are or not compatible, check this:\n\n-   \\[$2\\times2$\\]\\[ $3\\times 1$\\] $=$ Nonsense\n\n-   \\[$3\\times2$\\]\\[ $2\\times 1$\\] $=$ \\[$3\\times 1$\\]\n\n-   \\[$2\\times3$\\]\\[ $3\\times 1$\\] $=$ \\[$2\\times 1$\\]\n\n-   \\[$3\\times2$\\]\\[ $3\\times 1$\\] $=$ Nonsense\n\n-   \\[$1\\times3$\\]\\[ $3\\times 1$\\] $=$ \\[$1\\times 1$\\]\n\n## Solving the system using the Elimination method\n\n::: {.callout-tip appearance=\"simple\"}\n## Video\n\n[Ideas behind elimination method](https://youtu.be/km8A4JhQma8){target=\"_blank\"}\n:::\n\nLets solve the system @eq-sist using the traditional rules we already know from high-school, recall:\n\n1.  you can replace an equation by itself times some constant.\n2.  you can replace any one equation by the sum both equations.\n3.  you can isolate $x$ or $y$ in one equation and substitute in the other equation.\n\nIn other words, 1. and 2., just say this: you can replace $l_1$ or $l_2$ by some convenient combination $al_1+bl_2$. Rule 3. is known as back-substitution.\n\nApplying any one of these operations yields another and equivalent system of equations.\n\nThe central idea of the Elimination method is use linear combination of equations (1. and 2.) to eliminate variables and thus giving us an *equivalent* and *easier to solve* system. To eliminate variables we make clever use of rules $1$ and $2$. Once the system is simple enough we can use rule $3$. How do you know what is or not a good combination? We'll see that with examples. But the guiding principle is to use the pivots.\n\nThis recaps what you know and use these rules to solve the @eq-sist and in parallel see the corresponding matrix-vector version.\n\n-   **step 1:** Replace equation $l_2$ by, $l_2$ minus twice the equation $l_1$, i.e., make the new second equation $l_2'$ into $l_2-2l_1$. This gives us:\n\n    $$\n    \\begin{cases}x-4y =2\\\\2x-6y = 5\\end{cases} \\overset{l_2'=l_2-2l_1}{\\longrightarrow}\\begin{cases} x-4y =2\\\\ 2y = 1\\end{cases}\n    $$\n\n    Correspondingly in @eq-matrix_sist we subtract from row $l_2$ twice the row $l_1$, giving us\n\n    $$\n    \\begin{pmatrix} 1 & -4\\\\ 2 & -6 \\end{pmatrix}\\begin{pmatrix}x\\\\y\\end{pmatrix}= \\begin{pmatrix}2\\\\5\\end{pmatrix}\\overset{l_2'=l_2-2l_1}{\\longrightarrow} \\begin{pmatrix} 1 & -4\\\\ 0 & 2 \\end{pmatrix}\\begin{pmatrix}x\\\\y\\end{pmatrix}= \\begin{pmatrix}2\\\\1\\end{pmatrix}\n    $$\n\n    A good way to look at this is to focus on using the matrix entry $1$, to eliminate the matrix entry $2$. This entry $1$ is called a pivot entry!\n\n-   **step 2:** Multiply equation $l_2$ by $1/2$:\n\n    $$\n    \\begin{cases} x-4y =2\\\\ 2y = 1\\end{cases}\\overset{l_2'=1/2l_2}{\\longrightarrow} \\begin{cases} x-4y =2\\\\ y = 1/2\\end{cases}\n    $$\n\n    In matrix-vector notation we find:\n\n    $$\n    \\begin{pmatrix} 1 & -4\\\\ 0 & 2 \\end{pmatrix}\\begin{pmatrix}x\\\\y\\end{pmatrix}= \\begin{pmatrix}2\\\\1\\end{pmatrix}\\overset{l_2'=1/2l_2}{\\longrightarrow} \\begin{pmatrix} 1 & -4\\\\ 0 & 1 \\end{pmatrix}\\begin{pmatrix}x\\\\y\\end{pmatrix}= \\begin{pmatrix}2\\\\1/2\\end{pmatrix}\n    $$\n\n-   **step 3:** Focusing on the second pivot, the $1$ in row $l_2$, we eliminate the entry, $-4$, by replacing $l_1$ by $l_1$ plus four times $l_2$:\n\n    $$\n    \\begin{cases} x -4y =2\\\\ y = 1/2\\end{cases}\\overset{l_1'=l_1+4l_2}{\\longrightarrow}\\begin{cases} x =4\\\\ y = 1/2\\end{cases}\n    $$\n\n    In matrix-vector notation we find:\n\n    $$\n    \\begin{pmatrix} 1 & -4\\\\ 0 & 1 \\end{pmatrix}\\begin{pmatrix}x\\\\y\\end{pmatrix}= \\begin{pmatrix}2\\\\1/2\\end{pmatrix}\\overset{l_1'=l_1+4l_2}{\\longrightarrow} \\begin{pmatrix} 1 & 0\\\\ 0 & 1 \\end{pmatrix}\\begin{pmatrix}x\\\\y\\end{pmatrix}= \\begin{pmatrix}4\\\\1/2\\end{pmatrix}\n    $$\n\n    From which we can read the final result $x=4$ and $y=1/2$.\n\n**Better notation:** Going through the three steps again we notice we can improve our matrix-vector notation by suppressing the column $\\begin{pmatrix}x\\\\y\\end{pmatrix}$ and writing instead the steps as:\n\n$$\n\\left(\\begin{matrix} 1 & -4 \\\\ 2 & -6 \\end{matrix}\\;\\middle|\\; \\begin{matrix} 2\\\\5\\end{matrix}\\right)\n\\overset{l_2'=l_2-2l_1}{\\longrightarrow} \n\\left(\\begin{matrix} 1 & -4 \\\\ 0 & 2 \\end{matrix}\\;\\middle|\\; \\begin{matrix} 2\\\\1\\end{matrix}\\right)\n\\overset{l_2'=1/2l_2}{\\longrightarrow}\n\\left(\\begin{matrix} 1 & -4 \\\\ 0 & 1 \\end{matrix}\\;\\middle|\\; \\begin{matrix} 2\\\\1/2\\end{matrix}\\right)\n\\overset{l_1'=l_1+4l_2}{\\longrightarrow}\n\\left(\\begin{matrix} 1 & 0 \\\\ 0 & 1 \\end{matrix}\\;\\middle|\\; \\begin{matrix} 4\\\\1/2\\end{matrix}\\right)\n$$\n\nFrom now on we'll adopt this way of writing systems of equations, its called the extended matrix notation, because we appended a new column to right side of the $2\\times2$ matrix. From the extended matrix we read the solution as follows\n\n$$\n\\left(\\begin{matrix} 1 & 0 \\\\ 0 & 1 \\end{matrix}\\;\\middle|\\; \\begin{matrix} 4\\\\1/2\\end{matrix}\\right)\\longrightarrow \\begin{pmatrix} 1 & 0\\\\ 0 & 1 \\end{pmatrix}\\begin{pmatrix}x\\\\y\\end{pmatrix}= \\begin{pmatrix}4\\\\1/2\\end{pmatrix}\\longrightarrow \\begin{pmatrix}x\\\\y\\end{pmatrix}= \\begin{pmatrix}4\\\\1/2\\end{pmatrix}\n$$\n\nwhere in the last step we multiplied the vector by the matrix.\n\nThe vector\n\n$$\n\\begin{pmatrix}4\\\\1/2\\end{pmatrix}\n$$\n\nis the solution of\n\n$$\n\\begin{pmatrix} 1 & -4\\\\ 2 & -6 \\end{pmatrix}\\begin{pmatrix}x\\\\y\\end{pmatrix}= \\begin{pmatrix}2\\\\5\\end{pmatrix}\n$$\n\nMeaning, the solution of\n\n$$\n\\begin{cases}x-4y =2\\\\2x-6y = 5\\end{cases}\n$$\n\nis:\n\n$$\n\\begin{cases}x =4\\\\y=1/2\\end{cases}\n$$\n\n## More examples of the elimination method\n\nThe following examples will be given:\n\n-   A system with one solution\n\n-   A system with no solution\n\n-   A system with many solutions\n\n-   Another system with many solutions\n\n### Example 1: A system with one solution\n\n::: {.callout-tip appearance=\"simple\"}\n## Video\n\n[the example below in video](https://youtu.be/6fIdP9zjeKQ){target=\"_blank\"}\n:::\n\nConsider the following system written in three different notations.\n\n$$\n\\begin{cases}\nx+y-z=1\\\\\n2x-y+2z = 9\\\\\n2y=-x+z\n\\end{cases}\n\\leftrightsquigarrow\n\\begin{pmatrix}\n1 & 1 & -1\\\\\n2 & -1 & 2\\\\\n1 & 2 &-1\n\\end{pmatrix}\n\\begin{pmatrix}\nx\\\\\ny\\\\\nz\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1\\\\\n9\\\\\n0\n\\end{pmatrix}\n\\leftrightsquigarrow\n\\left(\n\\begin{matrix}\n1 & 1 & -1\\\\\n2 & -1 & 2\\\\\n1 & 2 & -1\n\\end{matrix}\n\\;\\middle|\\;\n\\begin{matrix}\n1\\\\\n9\\\\\n0\n\\end{matrix}\n\\right)\n$$ {#eq-possible_1}\n\n(This system represents the interception of three planes, each row of the matrix is a vector perpendicular to a plane)\n\nAgain we'll use the extended notation during the elimination algorithm, because we don't want to carry around the $x$, $y$ and $z$ at each step.\n\n$$\n\\begin{align}\n&\\left(\\begin{matrix}1 & 1 & -1\\\\2 & -1 & 2 \\\\1 & 2 & -1 \\end{matrix}\\;\\middle|\\;\\begin{matrix}1\\\\9\\\\0 \\end{matrix}\\right)\n \\overset{l_2'=l_2-2l_1\\\\l_3'=l_3-l_1}{\\longrightarrow}\n\\left(\\begin{matrix}1 & 1 & -1 \\\\0 & -3 & 4 \\\\0 & 1 & 0 \\end{matrix}\\;\\middle|\\;\\begin{matrix}1\\\\7\\\\-1\\end{matrix}\\right) \n\\overset{l_2 \\leftrightarrow l_3}{\\longrightarrow}\n\\left(\\begin{matrix}1 & 1 & -1 \\\\0 & 1 & 0\\\\0 & -3 & 4\\end{matrix}\\;\\middle|\\;\\begin{matrix}1\\\\-1\\\\7\\end{matrix}\\right)\\\\\n\\overset{l_3'=l_3+3l_2}{\\longrightarrow}\n&\\left(\\begin{matrix}1 & 1 & -1 \\\\0 & 1 & 0 \\\\0 & 0 & 4 \\end{matrix}\\;\\middle|\\;\\begin{matrix}1\\\\-1\\\\4\\end{matrix}\\right) \n\\overset{l_3'=l_3/4}{\\longrightarrow}\\left(\\begin{matrix}1 & 1 & -1 \\\\0 & 1 & 0 \\\\0 & 0 & 1 \\end{matrix}\\;\\middle|\\;\\begin{matrix}1\\\\-1\\\\1\\end{matrix}\\right) \n\\overset{l_1'=l_1+l_3}{\\longrightarrow}\\left(\\begin{matrix}1 & 1 & 0 \\\\0 & 1 & 0 \\\\0 & 0 & 1 \\end{matrix}\\;\\middle|\\;\\begin{matrix}2\\\\-1\\\\1\\end{matrix}\\right) \\\\\n\\overset{l_1'=l_1-l_2}{\\longrightarrow}\n&\\left(\\begin{matrix}1 & 0 & 0 \\\\0 & 1 & 0 \\\\0 & 0 & 1 \\end{matrix} \\;\\middle|\\;\\begin{matrix}3\\\\-1\\\\1\\end{matrix}\\right)\n\\end{align}\n$$\n\nEach step has its own commentary:\n\n1.  On the first step we use the pivot $A_{11}=1$ to eliminate the entries $2$ and $1$ bellow.\n\n2.  The second step we switched equations, so as to bring a pivot $1$ at position $A_{22}$.\n\n3.  The third step consists in using this pivot to eliminate the entry $-3$ below.\n\n4.  In step four we divided $l_3$ by $4$ so that that the pivot $A_{33}$ is $1$ instead of $4$.\n\n5.  At step five we use $A_{33}$ to eliminate the entry $-1$ above it.\n\n6.  Step six we just used the pivot $A_{22}$, to eliminate the entry $1$ at $A_{12}$.\n\nAfter simplification, it is time to go back to the original notation - we find:\n\n$$\n\\begin{cases}\nx = 3\\\\y=-1\\\\z=1\n\\end{cases}\n$$\n\nwhich is the solution of the system of equations! Correspondingly, the solution for the matrix-vector notation is the following vector\n\n$$\n\\begin{pmatrix}\n2\\\\\n-1\\\\\n1\n\\end{pmatrix}\n$$\n\n*Important observations (that we'll come very useful later):* the form of the matrix after all these l.c. of rows, known as the reduced matrix, $A'$, it has the form of a $3\\times 3$ identity matrix:\n\n$$\n\\begin{pmatrix}I\\end{pmatrix}\n$$\n\nand its rank is $3$, meaning, the number of pivots if $3$. Note as well that if we consider each column of the matrix as a vector, then we find $3$ independent vectors. We write $r=3$.\n\n::: {#def-rank style=\"color:gray\"}\n\\[rank $r$ of a matrix $A$\\] = $r$ = \\[# of pivots\\] =\\[# of indep columns of $A$ or $A'$\\] = \\[# of indep rows of $A$ or $A'$\\]=\\[rank of the reduced matrix $A'$\\]\n:::\n\nMoreover, notice that the rank of the extended matrix $r^*$ is also $3$. And that the number of columns $n=3$ as well.\n\nFrom this example we see something that happens in general:\n\n*A system of equations* $A\\mathbf{x}=\\mathbf{b}$ *have one solution provided* $r=r^*=n$.\n\n### Example 2: A system with no solution\n\nThe system this time is:\n\n$$\n\\begin{cases}\n2x-y=8\\\\\ny+2x = 4\\\\\nx=-y-1\n\\end{cases}\n\\leftrightsquigarrow\n\\begin{pmatrix}\n2 & -1\\\\\n2 & 1\\\\\n1 & 1\n\\end{pmatrix}\n\\begin{pmatrix}\nx\\\\\ny\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n8\\\\\n4\\\\\n-1\n\\end{pmatrix}\n\\leftrightsquigarrow\n\\left(\n\\begin{matrix}\n2 & -1 \\\\\n2 & 1  \\\\\n1 & 1 \n\\end{matrix}\n\\;\\middle|\\;\n\\begin{matrix}\n8\\\\\n4\\\\\n-1\n\\end{matrix}\n\\right)\n$$ {#eq-impossible_1}\n\nTo find how many solutions $\\begin{pmatrix}x\\\\y\\end{pmatrix}$ are there, we try to compute them using the Elimination algorithm:\n\n$$\n\\begin{align}\n&\\left(\\begin{matrix}2 & -1 \\\\2 & 1 \\\\1 & 1  \\end{matrix}\\;\\middle|\\;\\begin{matrix}8\\\\4\\\\-1\\end{matrix}\\right)\n\\overset{l_1\\leftrightarrow l_3}{\\longrightarrow}\n\\left(\\begin{matrix}1 & 1\\\\ 2 & 1 \\\\2 & -1 \\end{matrix} \\;\\middle|\\;\\begin{matrix}-1\\\\4\\\\8\\end{matrix}\\right)\n\\overset{l_2'=l_2-2l_1\\\\l_3'=l_3-2l_1}{\\longrightarrow}\n\\left(\\begin{matrix}1 & 1 \\\\0 & -1 \\\\0 & -3 \\end{matrix}\\;\\middle|\\;\\begin{matrix}-1\\\\6\\\\10\\end{matrix}\\right)\\\\\n\\overset{l_2'=-l_2\\\\l_3'=l_3-3l_2}{\\longrightarrow}\n&\\left(\\begin{matrix}1 & 1 \\\\0 & 1 \\\\0 & 0 \\end{matrix} \\;\\middle|\\; \\begin{matrix}-1\\\\-6\\\\-8\\end{matrix}\\right)\n\\overset{l_1'=l_1-l_2}{\\longrightarrow}\n\\left(\\begin{matrix}1 & 0 \\\\0 & 1 \\\\0 & 0 \\end{matrix} \\;\\middle|\\;\\begin{matrix}5\\\\-6\\\\-8\\end{matrix}\\right)\n\\end{align}\n$$\n\nThis means:\n\n$$\n\\left(\\begin{matrix}1 & 0 \\\\0 & 1 \\\\0 & 0 \\end{matrix} \\;\\middle|\\;\\begin{matrix}5\\\\-6\\\\-8\\end{matrix}\\right)\n\\leftrightsquigarrow\n\\begin{pmatrix}1 & 0 \\\\0 & 1 \\\\0 & 0 \\end{pmatrix} \\begin{pmatrix}x\\\\y\\end{pmatrix}=\\begin{pmatrix}5\\\\-6\\\\-8\\end{pmatrix}\n$$\n\nNow that most simplification is done, lets convert back to the system's notation:\n\n$$\n\\begin{cases}\nx=5\\\\\ny=-6\\\\\n0=-8\n\\end{cases}\n$$ {#eq-impossible_2}\n\nIt is clearly impossible. No choice of $x$ or $y$ makes this three statements true simultaneously! Since @eq-impossible_1 is equivalent to @eq-impossible_2, therefore our original system @eq-impossible_1 has no solution as well.\n\n*Observations:* Notice the form of the reduced matrix, $A'$ is\n\n$$\n\\begin{pmatrix}I\\\\\\mathbf{0}\\end{pmatrix}\n$$\n\nThe fact that $r=2$, $r^*=3$ and $n=2$, shows that $r<r^*$.\n\nIn general: *A system of equations* $A\\mathbf{x}=\\mathbf{b}$ *have no solution provided* $r<r^*$.\n\n### Example 3: A system with many solutions\n\nThe system is:\n\n$$\n\\begin{cases}\nx+y-z=0\\\\\n2x-y+2z = 0\\\\\n\\end{cases}\n\\leftrightsquigarrow\n\\begin{pmatrix}\n1 & 1 & -1\\\\\n2 & -1 & 2\\\\\n\\end{pmatrix}\n\\begin{pmatrix}\nx\\\\\ny\\\\\nz\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0\\\\\n0\n\\end{pmatrix}\n\\leftrightsquigarrow\n\\left(\n\\begin{matrix}\n1 & 1 & -1\\\\\n2 & -1 & 2 \\\\\n\\end{matrix}\n\\;\\middle|\\;\n\\begin{matrix}\n0\\\\0\n\\end{matrix}\n\\right)\n$$ {#eq-many_1}\n\nSolving:\n\n$$\n\\begin{align}\n&\\begin{pmatrix}1 & 1 & -1 &\\bigm| & 0\\\\2 & -1 & 2 &\\bigm| & 0\\\\\\end{pmatrix}\n\\overset{l_2'=l_2-2l_1}{\\longrightarrow}\n\\begin{pmatrix}1 & 1 & -1 &\\bigm| & 0\\\\0 & -3 & 4 &\\bigm| & 0\\end{pmatrix} \n\\overset{l_2'=-1/3l_2}{\\longrightarrow}\n\\begin{pmatrix}1 & 1 & -1 &\\bigm| & 0\\\\0 & 1 & -4/3 &\\bigm| & 0\\end{pmatrix}\\\\\n\\overset{l_1'=l_1-l_2}{\\longrightarrow}\n&\\begin{pmatrix}1 & 0 & 1/3 &\\bigm| & 0\\\\0 & 1 & -4/3 &\\bigm| & 0\\end{pmatrix} \n\\end{align}\n$$\n\nOnce again, this notation means:\n\n$$\n\\begin{pmatrix}1 & 0 & 1/3 &\\bigm| & 0\\\\0 & 1 & -4/3 &\\bigm| & 0\\end{pmatrix} \n\\leftrightsquigarrow \n\\begin{pmatrix}1 & 0 & 1/3\\\\0 & 1 & -4/3 \\end{pmatrix}\n\\begin{pmatrix}x\\\\y\\\\z\\end{pmatrix}\n=\n\\begin{pmatrix}0\\\\0\\end{pmatrix}\n$$ {#eq-ex4}\n\nConverting back to the system notation have:\n\n$$\n\\begin{cases}\nx+1/3z =0\\\\\ny-4/3z=0\n\\end{cases} \n\\iff\n\\begin{cases}\nx=-1/3z\\\\\ny=4/3z\n\\end{cases}\n$$ {#eq-many_2}\n\nAsking what $(x,y,z)\\in \\mathbb{R}^3$ that satisfy the equation @eq-many_1 is equivalent to ask, what is $x,y,z\\in \\mathbb{R}$ that satisfy @eq-many_2 . Each real $z$ we choose gives us the corresponding $x$ and $y$; as a consequence we have many solution. In other words, the solution is\n\n$$\n\\begin{pmatrix}\nx\\\\\ny\\\\\nz\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n-1/3z\\\\\n4/3z\\\\\nz\n\\end{pmatrix}\n$$ {#eq-parameter_dep_sol}\n\n*Observations*: The form of the reduced matrix is:\n\n$$\n\\begin{pmatrix}I \\,\\,F\\end{pmatrix}\n$$\n\nwhere the $F$ block is the third column $(1/3, -4/3)^\\intercal$, while $I$ is the $2$ by $2$ identity.\n\nAdditionally, $r=2$, $r^*=2$ and $n=3$. A general rule (to be explained later) is:\n\n*A system of equations* $A\\mathbf{x}=\\mathbf{b}$ *have infinite solutions provided* $r=r^*<n$.\n\n### Example 4: Another system with many solutions\n\nWhat is the solution $(x,y, z, w)$ for the following system:\n\n$$\n\\begin{cases}\n&x&+ &2 y&+&2 z &+&2w &= 1\\\\\n&2x&+&4y&+&6z&+&8w &= 2\\\\\n&3x&+&6y&+&8z&+&10w &=3\n\\end{cases}\n$$\n\nUsing elimination algorithm we make linear combinations of the equation with the goal of eliminating variables, here is one way to go\\\n$$\n\\begin{align}\n&\\begin{pmatrix}\n1 & 2 & 2 & 2 &\\bigm|1\\\\\n2 & 4 & 6 & 8 &\\bigm|2\\\\\n3 & 6 & 8 & 10 &\\bigm| 3\n\\end{pmatrix}\n\\overset{l_2' = l_2-2l_1}{\\longrightarrow}\n\\begin{pmatrix}\n1 & 2 & 2 & 2 &\\bigm| 1\\\\\n0 & 0 & 2 & 4 &\\bigm| 0\\\\\n3 & 6 & 8 & 10 &\\bigm| 3\n\\end{pmatrix}\n\\overset{l_3' = l_3-3l_1}{\\longrightarrow}\n\\begin{pmatrix}\n1 & 2 & 2 & 2 &\\bigm| 1\\\\\n0 & 0 & 2 & 4 &\\bigm| 0\\\\\n0 & 0 & 2 & 4 &\\bigm| 0\n\\end{pmatrix}\\\\\n&\\overset{l_3'=l_3-l_2}{\\longrightarrow}\n\\begin{pmatrix}\n1 & 2 & 2 & 2 &\\bigm| 1\\\\\n0 & 0 & 2 & 4 &\\bigm| 0\\\\\n0 & 0 & 0 & 0 &\\bigm| 0\n\\end{pmatrix}\n\\overset{l_2'=1/2l_2}{\\longrightarrow}\n\\begin{pmatrix}\n1 & 2 & 2 & 2 &\\bigm| 1\\\\\n0 & 0 & 1 & 2 &\\bigm| 0\\\\\n0 & 0 & 0 & 0 &\\bigm| 0\n\\end{pmatrix}\n\\overset{l_1'=l_1-2l_2}{\\longrightarrow}\n\\begin{pmatrix}\n1 & 2 & 0 & -2 &\\bigm| 1\\\\\n0 & 0 & 1 & 2 &\\bigm| 0\\\\\n0 & 0 & 0 & 0 &\\bigm| 0\n\\end{pmatrix}\n\\end{align}\n$$ {#eq-example_4_system}\n\nWe simplified it as much as we can, going back to the system's notation we have:\n\n$$\n\\begin{cases}\nx + 2 y & &- &2w &=1\\\\\n&z &+ &2w &=0\n\\end{cases}\n$$\n\nNow, promote $y$ and $w$ into parameters and express $x$ and $z$ in term of them:\n\n$$\n\\begin{cases}\nx + 2 y & &- &2w &=1\\\\\n&z &+ &2w &=0\n\\end{cases}\n\\longrightarrow\n\\begin{cases}\nx &=1-2y&-&2w\\\\\nz &=&-&2w\n\\end{cases}\n$$ {#eq-sol_1}\n\nFor each values we assign to $y$ and $w$ we get one solution! There's an infinite number of them.\n\nThis example is given so that you can see, that the final aesthetic of the reduced $A'$ may have the $I$ and $F$ blocks mixed!\n\nThis is also a matrix with form:\n\n$$\n\\begin{pmatrix}I \\,\\,F\\end{pmatrix}\n$$\n\nThe rank is $r=2$, the rank of the extended matrix is $r^*=2$, meanwhile $n=4$. Since $r=r^*<n$ we have an infinite number of solutions.\n\n### Example 5: A system that may have one, none or many solutions\n\nWhat is the solution of:\n\n$$\n\\begin{cases}\n&x&+ &k y&+&2 z &= 1\\\\\n&x&+&y&+&(k+1)z &= k\\\\\n&-x&-&y&-&z &=k+1\n\\end{cases}\n$$\n\nUsing the extended matrix formulation we use the pivots to eliminate entries:\n\n$$ \\begin{align} &\\begin{pmatrix} 1 & k & 2  &\\bigm|1\\\\ 1 & 1 & k+1 &\\bigm|k\\\\ -1 & -1 & -1 &\\bigm| k+1 \\end{pmatrix} \\overset{l_2' = l_2-l_1\\\\l_3'=l_3+l_1}{\\longrightarrow} \\begin{pmatrix} 1 & k & 2 &\\bigm| 1\\\\ 0 & 1-k & k-1 &\\bigm| k-1\\\\ 0 & k-1 & 1 &\\bigm| k+2 \\end{pmatrix} \\overset{l_3' = l_3+l_2}{\\longrightarrow} \\begin{pmatrix} 1 & k & 2  &\\bigm| 1\\\\ 0 & 1-k & k-1 &\\bigm| k-1\\\\ 0 & 0 & k &\\bigm| 2k+1 \\end{pmatrix} \\end{align} $$\n\nNow, depending upon on the value $k$ the system may have one, none or many solutions:\n\n-   For $k=1$ then\n\n$$\n\\begin{pmatrix} 1 & 1 & 2  &\\bigm|1\\\\ 0 & 0 & 0 &\\bigm|0\\\\ 0 & 0 & 1 &\\bigm| 3 \\end{pmatrix} \\overset{l_2 \\leftrightarrow l_3}{\\longrightarrow} \\begin{pmatrix} 1 & 1 & 2  &\\bigm|1\\\\ 0 & 0 & 1 &\\bigm|3\\\\ 0 & 0 & 0 &\\bigm| 0 \\end{pmatrix}\\overset{l_1'=l_1-2l_2 }{\\longrightarrow}\\begin{pmatrix} 1 & 1 & 0  &\\bigm|-5\\\\ 0 & 0 & 1 &\\bigm|3\\\\ 0 & 0 & 0 &\\bigm| 0 \\end{pmatrix}\n$$ {#eq-k1}\n\nwhich has the form:\n\n$$\n\\begin{pmatrix}I\\,\\,F \\end{pmatrix}\n$$\n\nand: $r=2$, $r^*=2$ and $n=3$.\n\nSince $r=r^*<n$ we conclude we have an infinite number of solutions as we readily check by actually computing them. From @eq-k1 we know:\n\n$$\n\\begin{cases}\nx + y = -5\\\\\nz=3\n\\end{cases}\n$$\n\nSince we have two equations and three unknowns, we promote one of them, let it be $x$, to the status of a parameter $x_0$, hence:\n\n$$\n\\begin{pmatrix}x\\\\y\\\\z\\end{pmatrix}=\\begin{pmatrix}x_0\\\\-5-x_0\\\\3\\end{pmatrix}=\\begin{pmatrix}0\\\\-5\\\\3\\end{pmatrix}+x_0\\begin{pmatrix}1\\\\-1\\\\0\\end{pmatrix}\n$$\n\nFor each $x_0$ of our choice we have a distinct solution. There is infinite of them.\n\n-   For $k=0$\n\n$$\n\\begin{pmatrix} 1 & 0 & 2  &\\bigm|1\\\\ 0 & 1 & -1 &\\bigm|-1\\\\ 0 & 0 & 0 &\\bigm| 1 \\end{pmatrix} \n$$\n\nThe system has the form:\n\n$$\n\\begin{pmatrix}\nI & F\\\\\n\\mathbf{0} &\\mathbf{0}\n\\end{pmatrix}\n$$\n\nAnd note: $r=2$, $r^*=3$ and $n=3$, thus $r<r^*=n$ which tells us there is no solution. In fact we can see why by rolling back to:\n\n$$\n\\begin{cases}\nx+2z=1\\\\\ny-z =-1\\\\\n0=1\n\\end{cases}\n$$\n\nThere are no $x$, $y$ and $z$ that satisfies these three equations simultaneously.\n\n-   If $k$ is not $0,1$ then we always have $r=r^*=n$, thus, there is always a unique solution.\n\n**In summary:**\n\n-   *A system of equations* $A\\mathbf{x}=\\mathbf{b}$ *have infinite solutions provided* $r=r^*<n$.\n\n-   *A system of equations* $A\\mathbf{x}=\\mathbf{b}$ *have one solution provided* $r=r^*=n$.\n\n-   *A system of equations* $A\\mathbf{x}=\\mathbf{b}$ *have no solutions provided* $r<r^*$.\n\n::: callout-note\n## Commentaries\n\n-   For the moment assume this summary as a fact of life, later we'll justify in detail the meaning of this triple equality, for know just focus on learning elimination and testing the triple equality\n\n-   How do we know how many pivots are there? Use elimination method to introduce in the matrix as many zeros as possible, giving us the reduced form $A'$. Counting the pivots in $A'$ is easy. Recall that the number of pivots of $A$ is the same as $A'$.\n\n-   A matrix where all entries below the pivots were killed is in triangular form. Back substitution can already be used at this stage. (we did not do this in the examples, but we could) If we proceed and also kill all entries above the pivots, we get the best matrix (this is what we did in the examples above). A matrix is then said to be in *reduced row echelon form*. Back substitution can also used at this final stage.\n:::\n","srcMarkdownNoYaml":"\n\nLets review the method you use in high-school to solve systems of equations - *the elimination method* - and then rewrite it under a new notation - the matrix and vector notation.\n\nA few examples will be given.\n\nKey concepts: *systems of equations in matrix-vector notation, elimination, pivot, rank, conditions for 1,0 or infinite solutions.*\n\n## Matrix-vector notation for a system\n\n::: {.callout-tip appearance=\"simple\"}\n## Video\n\n[Translating between notation](https://youtu.be/Q2Q74yG5kQU){target=\"_blank\"}\n:::\n\nConsider the system with two equations, called $l_1$ and $l_2$:\n\n$$\n\\begin{cases}\nx-4y =2\\\\\n2x-6y = 5\n\\end{cases}\n$$ {#eq-sist}\n\nIn @eq-sist we find two equations and two unknowns $x$ and $y$. We want their values such that both equations are satisfied. (this system represents the interception of two lines)\n\nUsing the matrix-vector notation we can write @eq-sist as:\n\n$$\n\\begin{pmatrix} 1 & -4\\\\ 2 & -6 \\end{pmatrix}\\begin{pmatrix}x\\\\y\\end{pmatrix}= \\begin{pmatrix}2\\\\5\\end{pmatrix}\n$$ {#eq-matrix_sist}\n\nLets read @eq-matrix_sist in words: the $2$ by $2$ matrix of coefficients is multiplied by the column vector $\\begin{pmatrix}x\\\\y\\end{pmatrix}$ , the result is $\\begin{pmatrix}2\\\\5\\end{pmatrix}$. This is *one* equation with *one* unknown, the column vector $\\begin{pmatrix}x\\\\y\\end{pmatrix}$. Traditionally we write @eq-matrix_sist as $A \\mathbf{x} =\\mathbf{b}$.\n\nHow do we multiply a vector by a matrix?\n\n*Answer:*\n\n$$\n\\overbrace{\\begin{pmatrix} 1 & -4\\\\ 2 & -6 \\end{pmatrix}\\begin{pmatrix}x\\\\y\\end{pmatrix}}^\\text{matrix-vector mult.} =\\overbrace{\\begin{pmatrix}1\\cdot x-4\\cdot y \\\\ 2\\cdot x-6\\cdot y\\end{pmatrix}}^\\text{scalar mult.}\n$$\n\nMatrix times a vector on the lhs is just a super-compact way of writing the vector on the rhs. Moreover, notice the shapes of the matrix and vectors, this is very, very important. A $2$ by $2$ matrix times a $2$ by $1$ column vector yields a $2$ by $1$ column vector! If you understand this it should not be a problem to see what shapes are or not compatible, check this:\n\n-   \\[$2\\times2$\\]\\[ $3\\times 1$\\] $=$ Nonsense\n\n-   \\[$3\\times2$\\]\\[ $2\\times 1$\\] $=$ \\[$3\\times 1$\\]\n\n-   \\[$2\\times3$\\]\\[ $3\\times 1$\\] $=$ \\[$2\\times 1$\\]\n\n-   \\[$3\\times2$\\]\\[ $3\\times 1$\\] $=$ Nonsense\n\n-   \\[$1\\times3$\\]\\[ $3\\times 1$\\] $=$ \\[$1\\times 1$\\]\n\n## Solving the system using the Elimination method\n\n::: {.callout-tip appearance=\"simple\"}\n## Video\n\n[Ideas behind elimination method](https://youtu.be/km8A4JhQma8){target=\"_blank\"}\n:::\n\nLets solve the system @eq-sist using the traditional rules we already know from high-school, recall:\n\n1.  you can replace an equation by itself times some constant.\n2.  you can replace any one equation by the sum both equations.\n3.  you can isolate $x$ or $y$ in one equation and substitute in the other equation.\n\nIn other words, 1. and 2., just say this: you can replace $l_1$ or $l_2$ by some convenient combination $al_1+bl_2$. Rule 3. is known as back-substitution.\n\nApplying any one of these operations yields another and equivalent system of equations.\n\nThe central idea of the Elimination method is use linear combination of equations (1. and 2.) to eliminate variables and thus giving us an *equivalent* and *easier to solve* system. To eliminate variables we make clever use of rules $1$ and $2$. Once the system is simple enough we can use rule $3$. How do you know what is or not a good combination? We'll see that with examples. But the guiding principle is to use the pivots.\n\nThis recaps what you know and use these rules to solve the @eq-sist and in parallel see the corresponding matrix-vector version.\n\n-   **step 1:** Replace equation $l_2$ by, $l_2$ minus twice the equation $l_1$, i.e., make the new second equation $l_2'$ into $l_2-2l_1$. This gives us:\n\n    $$\n    \\begin{cases}x-4y =2\\\\2x-6y = 5\\end{cases} \\overset{l_2'=l_2-2l_1}{\\longrightarrow}\\begin{cases} x-4y =2\\\\ 2y = 1\\end{cases}\n    $$\n\n    Correspondingly in @eq-matrix_sist we subtract from row $l_2$ twice the row $l_1$, giving us\n\n    $$\n    \\begin{pmatrix} 1 & -4\\\\ 2 & -6 \\end{pmatrix}\\begin{pmatrix}x\\\\y\\end{pmatrix}= \\begin{pmatrix}2\\\\5\\end{pmatrix}\\overset{l_2'=l_2-2l_1}{\\longrightarrow} \\begin{pmatrix} 1 & -4\\\\ 0 & 2 \\end{pmatrix}\\begin{pmatrix}x\\\\y\\end{pmatrix}= \\begin{pmatrix}2\\\\1\\end{pmatrix}\n    $$\n\n    A good way to look at this is to focus on using the matrix entry $1$, to eliminate the matrix entry $2$. This entry $1$ is called a pivot entry!\n\n-   **step 2:** Multiply equation $l_2$ by $1/2$:\n\n    $$\n    \\begin{cases} x-4y =2\\\\ 2y = 1\\end{cases}\\overset{l_2'=1/2l_2}{\\longrightarrow} \\begin{cases} x-4y =2\\\\ y = 1/2\\end{cases}\n    $$\n\n    In matrix-vector notation we find:\n\n    $$\n    \\begin{pmatrix} 1 & -4\\\\ 0 & 2 \\end{pmatrix}\\begin{pmatrix}x\\\\y\\end{pmatrix}= \\begin{pmatrix}2\\\\1\\end{pmatrix}\\overset{l_2'=1/2l_2}{\\longrightarrow} \\begin{pmatrix} 1 & -4\\\\ 0 & 1 \\end{pmatrix}\\begin{pmatrix}x\\\\y\\end{pmatrix}= \\begin{pmatrix}2\\\\1/2\\end{pmatrix}\n    $$\n\n-   **step 3:** Focusing on the second pivot, the $1$ in row $l_2$, we eliminate the entry, $-4$, by replacing $l_1$ by $l_1$ plus four times $l_2$:\n\n    $$\n    \\begin{cases} x -4y =2\\\\ y = 1/2\\end{cases}\\overset{l_1'=l_1+4l_2}{\\longrightarrow}\\begin{cases} x =4\\\\ y = 1/2\\end{cases}\n    $$\n\n    In matrix-vector notation we find:\n\n    $$\n    \\begin{pmatrix} 1 & -4\\\\ 0 & 1 \\end{pmatrix}\\begin{pmatrix}x\\\\y\\end{pmatrix}= \\begin{pmatrix}2\\\\1/2\\end{pmatrix}\\overset{l_1'=l_1+4l_2}{\\longrightarrow} \\begin{pmatrix} 1 & 0\\\\ 0 & 1 \\end{pmatrix}\\begin{pmatrix}x\\\\y\\end{pmatrix}= \\begin{pmatrix}4\\\\1/2\\end{pmatrix}\n    $$\n\n    From which we can read the final result $x=4$ and $y=1/2$.\n\n**Better notation:** Going through the three steps again we notice we can improve our matrix-vector notation by suppressing the column $\\begin{pmatrix}x\\\\y\\end{pmatrix}$ and writing instead the steps as:\n\n$$\n\\left(\\begin{matrix} 1 & -4 \\\\ 2 & -6 \\end{matrix}\\;\\middle|\\; \\begin{matrix} 2\\\\5\\end{matrix}\\right)\n\\overset{l_2'=l_2-2l_1}{\\longrightarrow} \n\\left(\\begin{matrix} 1 & -4 \\\\ 0 & 2 \\end{matrix}\\;\\middle|\\; \\begin{matrix} 2\\\\1\\end{matrix}\\right)\n\\overset{l_2'=1/2l_2}{\\longrightarrow}\n\\left(\\begin{matrix} 1 & -4 \\\\ 0 & 1 \\end{matrix}\\;\\middle|\\; \\begin{matrix} 2\\\\1/2\\end{matrix}\\right)\n\\overset{l_1'=l_1+4l_2}{\\longrightarrow}\n\\left(\\begin{matrix} 1 & 0 \\\\ 0 & 1 \\end{matrix}\\;\\middle|\\; \\begin{matrix} 4\\\\1/2\\end{matrix}\\right)\n$$\n\nFrom now on we'll adopt this way of writing systems of equations, its called the extended matrix notation, because we appended a new column to right side of the $2\\times2$ matrix. From the extended matrix we read the solution as follows\n\n$$\n\\left(\\begin{matrix} 1 & 0 \\\\ 0 & 1 \\end{matrix}\\;\\middle|\\; \\begin{matrix} 4\\\\1/2\\end{matrix}\\right)\\longrightarrow \\begin{pmatrix} 1 & 0\\\\ 0 & 1 \\end{pmatrix}\\begin{pmatrix}x\\\\y\\end{pmatrix}= \\begin{pmatrix}4\\\\1/2\\end{pmatrix}\\longrightarrow \\begin{pmatrix}x\\\\y\\end{pmatrix}= \\begin{pmatrix}4\\\\1/2\\end{pmatrix}\n$$\n\nwhere in the last step we multiplied the vector by the matrix.\n\nThe vector\n\n$$\n\\begin{pmatrix}4\\\\1/2\\end{pmatrix}\n$$\n\nis the solution of\n\n$$\n\\begin{pmatrix} 1 & -4\\\\ 2 & -6 \\end{pmatrix}\\begin{pmatrix}x\\\\y\\end{pmatrix}= \\begin{pmatrix}2\\\\5\\end{pmatrix}\n$$\n\nMeaning, the solution of\n\n$$\n\\begin{cases}x-4y =2\\\\2x-6y = 5\\end{cases}\n$$\n\nis:\n\n$$\n\\begin{cases}x =4\\\\y=1/2\\end{cases}\n$$\n\n## More examples of the elimination method\n\nThe following examples will be given:\n\n-   A system with one solution\n\n-   A system with no solution\n\n-   A system with many solutions\n\n-   Another system with many solutions\n\n### Example 1: A system with one solution\n\n::: {.callout-tip appearance=\"simple\"}\n## Video\n\n[the example below in video](https://youtu.be/6fIdP9zjeKQ){target=\"_blank\"}\n:::\n\nConsider the following system written in three different notations.\n\n$$\n\\begin{cases}\nx+y-z=1\\\\\n2x-y+2z = 9\\\\\n2y=-x+z\n\\end{cases}\n\\leftrightsquigarrow\n\\begin{pmatrix}\n1 & 1 & -1\\\\\n2 & -1 & 2\\\\\n1 & 2 &-1\n\\end{pmatrix}\n\\begin{pmatrix}\nx\\\\\ny\\\\\nz\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1\\\\\n9\\\\\n0\n\\end{pmatrix}\n\\leftrightsquigarrow\n\\left(\n\\begin{matrix}\n1 & 1 & -1\\\\\n2 & -1 & 2\\\\\n1 & 2 & -1\n\\end{matrix}\n\\;\\middle|\\;\n\\begin{matrix}\n1\\\\\n9\\\\\n0\n\\end{matrix}\n\\right)\n$$ {#eq-possible_1}\n\n(This system represents the interception of three planes, each row of the matrix is a vector perpendicular to a plane)\n\nAgain we'll use the extended notation during the elimination algorithm, because we don't want to carry around the $x$, $y$ and $z$ at each step.\n\n$$\n\\begin{align}\n&\\left(\\begin{matrix}1 & 1 & -1\\\\2 & -1 & 2 \\\\1 & 2 & -1 \\end{matrix}\\;\\middle|\\;\\begin{matrix}1\\\\9\\\\0 \\end{matrix}\\right)\n \\overset{l_2'=l_2-2l_1\\\\l_3'=l_3-l_1}{\\longrightarrow}\n\\left(\\begin{matrix}1 & 1 & -1 \\\\0 & -3 & 4 \\\\0 & 1 & 0 \\end{matrix}\\;\\middle|\\;\\begin{matrix}1\\\\7\\\\-1\\end{matrix}\\right) \n\\overset{l_2 \\leftrightarrow l_3}{\\longrightarrow}\n\\left(\\begin{matrix}1 & 1 & -1 \\\\0 & 1 & 0\\\\0 & -3 & 4\\end{matrix}\\;\\middle|\\;\\begin{matrix}1\\\\-1\\\\7\\end{matrix}\\right)\\\\\n\\overset{l_3'=l_3+3l_2}{\\longrightarrow}\n&\\left(\\begin{matrix}1 & 1 & -1 \\\\0 & 1 & 0 \\\\0 & 0 & 4 \\end{matrix}\\;\\middle|\\;\\begin{matrix}1\\\\-1\\\\4\\end{matrix}\\right) \n\\overset{l_3'=l_3/4}{\\longrightarrow}\\left(\\begin{matrix}1 & 1 & -1 \\\\0 & 1 & 0 \\\\0 & 0 & 1 \\end{matrix}\\;\\middle|\\;\\begin{matrix}1\\\\-1\\\\1\\end{matrix}\\right) \n\\overset{l_1'=l_1+l_3}{\\longrightarrow}\\left(\\begin{matrix}1 & 1 & 0 \\\\0 & 1 & 0 \\\\0 & 0 & 1 \\end{matrix}\\;\\middle|\\;\\begin{matrix}2\\\\-1\\\\1\\end{matrix}\\right) \\\\\n\\overset{l_1'=l_1-l_2}{\\longrightarrow}\n&\\left(\\begin{matrix}1 & 0 & 0 \\\\0 & 1 & 0 \\\\0 & 0 & 1 \\end{matrix} \\;\\middle|\\;\\begin{matrix}3\\\\-1\\\\1\\end{matrix}\\right)\n\\end{align}\n$$\n\nEach step has its own commentary:\n\n1.  On the first step we use the pivot $A_{11}=1$ to eliminate the entries $2$ and $1$ bellow.\n\n2.  The second step we switched equations, so as to bring a pivot $1$ at position $A_{22}$.\n\n3.  The third step consists in using this pivot to eliminate the entry $-3$ below.\n\n4.  In step four we divided $l_3$ by $4$ so that that the pivot $A_{33}$ is $1$ instead of $4$.\n\n5.  At step five we use $A_{33}$ to eliminate the entry $-1$ above it.\n\n6.  Step six we just used the pivot $A_{22}$, to eliminate the entry $1$ at $A_{12}$.\n\nAfter simplification, it is time to go back to the original notation - we find:\n\n$$\n\\begin{cases}\nx = 3\\\\y=-1\\\\z=1\n\\end{cases}\n$$\n\nwhich is the solution of the system of equations! Correspondingly, the solution for the matrix-vector notation is the following vector\n\n$$\n\\begin{pmatrix}\n2\\\\\n-1\\\\\n1\n\\end{pmatrix}\n$$\n\n*Important observations (that we'll come very useful later):* the form of the matrix after all these l.c. of rows, known as the reduced matrix, $A'$, it has the form of a $3\\times 3$ identity matrix:\n\n$$\n\\begin{pmatrix}I\\end{pmatrix}\n$$\n\nand its rank is $3$, meaning, the number of pivots if $3$. Note as well that if we consider each column of the matrix as a vector, then we find $3$ independent vectors. We write $r=3$.\n\n::: {#def-rank style=\"color:gray\"}\n\\[rank $r$ of a matrix $A$\\] = $r$ = \\[# of pivots\\] =\\[# of indep columns of $A$ or $A'$\\] = \\[# of indep rows of $A$ or $A'$\\]=\\[rank of the reduced matrix $A'$\\]\n:::\n\nMoreover, notice that the rank of the extended matrix $r^*$ is also $3$. And that the number of columns $n=3$ as well.\n\nFrom this example we see something that happens in general:\n\n*A system of equations* $A\\mathbf{x}=\\mathbf{b}$ *have one solution provided* $r=r^*=n$.\n\n### Example 2: A system with no solution\n\nThe system this time is:\n\n$$\n\\begin{cases}\n2x-y=8\\\\\ny+2x = 4\\\\\nx=-y-1\n\\end{cases}\n\\leftrightsquigarrow\n\\begin{pmatrix}\n2 & -1\\\\\n2 & 1\\\\\n1 & 1\n\\end{pmatrix}\n\\begin{pmatrix}\nx\\\\\ny\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n8\\\\\n4\\\\\n-1\n\\end{pmatrix}\n\\leftrightsquigarrow\n\\left(\n\\begin{matrix}\n2 & -1 \\\\\n2 & 1  \\\\\n1 & 1 \n\\end{matrix}\n\\;\\middle|\\;\n\\begin{matrix}\n8\\\\\n4\\\\\n-1\n\\end{matrix}\n\\right)\n$$ {#eq-impossible_1}\n\nTo find how many solutions $\\begin{pmatrix}x\\\\y\\end{pmatrix}$ are there, we try to compute them using the Elimination algorithm:\n\n$$\n\\begin{align}\n&\\left(\\begin{matrix}2 & -1 \\\\2 & 1 \\\\1 & 1  \\end{matrix}\\;\\middle|\\;\\begin{matrix}8\\\\4\\\\-1\\end{matrix}\\right)\n\\overset{l_1\\leftrightarrow l_3}{\\longrightarrow}\n\\left(\\begin{matrix}1 & 1\\\\ 2 & 1 \\\\2 & -1 \\end{matrix} \\;\\middle|\\;\\begin{matrix}-1\\\\4\\\\8\\end{matrix}\\right)\n\\overset{l_2'=l_2-2l_1\\\\l_3'=l_3-2l_1}{\\longrightarrow}\n\\left(\\begin{matrix}1 & 1 \\\\0 & -1 \\\\0 & -3 \\end{matrix}\\;\\middle|\\;\\begin{matrix}-1\\\\6\\\\10\\end{matrix}\\right)\\\\\n\\overset{l_2'=-l_2\\\\l_3'=l_3-3l_2}{\\longrightarrow}\n&\\left(\\begin{matrix}1 & 1 \\\\0 & 1 \\\\0 & 0 \\end{matrix} \\;\\middle|\\; \\begin{matrix}-1\\\\-6\\\\-8\\end{matrix}\\right)\n\\overset{l_1'=l_1-l_2}{\\longrightarrow}\n\\left(\\begin{matrix}1 & 0 \\\\0 & 1 \\\\0 & 0 \\end{matrix} \\;\\middle|\\;\\begin{matrix}5\\\\-6\\\\-8\\end{matrix}\\right)\n\\end{align}\n$$\n\nThis means:\n\n$$\n\\left(\\begin{matrix}1 & 0 \\\\0 & 1 \\\\0 & 0 \\end{matrix} \\;\\middle|\\;\\begin{matrix}5\\\\-6\\\\-8\\end{matrix}\\right)\n\\leftrightsquigarrow\n\\begin{pmatrix}1 & 0 \\\\0 & 1 \\\\0 & 0 \\end{pmatrix} \\begin{pmatrix}x\\\\y\\end{pmatrix}=\\begin{pmatrix}5\\\\-6\\\\-8\\end{pmatrix}\n$$\n\nNow that most simplification is done, lets convert back to the system's notation:\n\n$$\n\\begin{cases}\nx=5\\\\\ny=-6\\\\\n0=-8\n\\end{cases}\n$$ {#eq-impossible_2}\n\nIt is clearly impossible. No choice of $x$ or $y$ makes this three statements true simultaneously! Since @eq-impossible_1 is equivalent to @eq-impossible_2, therefore our original system @eq-impossible_1 has no solution as well.\n\n*Observations:* Notice the form of the reduced matrix, $A'$ is\n\n$$\n\\begin{pmatrix}I\\\\\\mathbf{0}\\end{pmatrix}\n$$\n\nThe fact that $r=2$, $r^*=3$ and $n=2$, shows that $r<r^*$.\n\nIn general: *A system of equations* $A\\mathbf{x}=\\mathbf{b}$ *have no solution provided* $r<r^*$.\n\n### Example 3: A system with many solutions\n\nThe system is:\n\n$$\n\\begin{cases}\nx+y-z=0\\\\\n2x-y+2z = 0\\\\\n\\end{cases}\n\\leftrightsquigarrow\n\\begin{pmatrix}\n1 & 1 & -1\\\\\n2 & -1 & 2\\\\\n\\end{pmatrix}\n\\begin{pmatrix}\nx\\\\\ny\\\\\nz\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0\\\\\n0\n\\end{pmatrix}\n\\leftrightsquigarrow\n\\left(\n\\begin{matrix}\n1 & 1 & -1\\\\\n2 & -1 & 2 \\\\\n\\end{matrix}\n\\;\\middle|\\;\n\\begin{matrix}\n0\\\\0\n\\end{matrix}\n\\right)\n$$ {#eq-many_1}\n\nSolving:\n\n$$\n\\begin{align}\n&\\begin{pmatrix}1 & 1 & -1 &\\bigm| & 0\\\\2 & -1 & 2 &\\bigm| & 0\\\\\\end{pmatrix}\n\\overset{l_2'=l_2-2l_1}{\\longrightarrow}\n\\begin{pmatrix}1 & 1 & -1 &\\bigm| & 0\\\\0 & -3 & 4 &\\bigm| & 0\\end{pmatrix} \n\\overset{l_2'=-1/3l_2}{\\longrightarrow}\n\\begin{pmatrix}1 & 1 & -1 &\\bigm| & 0\\\\0 & 1 & -4/3 &\\bigm| & 0\\end{pmatrix}\\\\\n\\overset{l_1'=l_1-l_2}{\\longrightarrow}\n&\\begin{pmatrix}1 & 0 & 1/3 &\\bigm| & 0\\\\0 & 1 & -4/3 &\\bigm| & 0\\end{pmatrix} \n\\end{align}\n$$\n\nOnce again, this notation means:\n\n$$\n\\begin{pmatrix}1 & 0 & 1/3 &\\bigm| & 0\\\\0 & 1 & -4/3 &\\bigm| & 0\\end{pmatrix} \n\\leftrightsquigarrow \n\\begin{pmatrix}1 & 0 & 1/3\\\\0 & 1 & -4/3 \\end{pmatrix}\n\\begin{pmatrix}x\\\\y\\\\z\\end{pmatrix}\n=\n\\begin{pmatrix}0\\\\0\\end{pmatrix}\n$$ {#eq-ex4}\n\nConverting back to the system notation have:\n\n$$\n\\begin{cases}\nx+1/3z =0\\\\\ny-4/3z=0\n\\end{cases} \n\\iff\n\\begin{cases}\nx=-1/3z\\\\\ny=4/3z\n\\end{cases}\n$$ {#eq-many_2}\n\nAsking what $(x,y,z)\\in \\mathbb{R}^3$ that satisfy the equation @eq-many_1 is equivalent to ask, what is $x,y,z\\in \\mathbb{R}$ that satisfy @eq-many_2 . Each real $z$ we choose gives us the corresponding $x$ and $y$; as a consequence we have many solution. In other words, the solution is\n\n$$\n\\begin{pmatrix}\nx\\\\\ny\\\\\nz\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n-1/3z\\\\\n4/3z\\\\\nz\n\\end{pmatrix}\n$$ {#eq-parameter_dep_sol}\n\n*Observations*: The form of the reduced matrix is:\n\n$$\n\\begin{pmatrix}I \\,\\,F\\end{pmatrix}\n$$\n\nwhere the $F$ block is the third column $(1/3, -4/3)^\\intercal$, while $I$ is the $2$ by $2$ identity.\n\nAdditionally, $r=2$, $r^*=2$ and $n=3$. A general rule (to be explained later) is:\n\n*A system of equations* $A\\mathbf{x}=\\mathbf{b}$ *have infinite solutions provided* $r=r^*<n$.\n\n### Example 4: Another system with many solutions\n\nWhat is the solution $(x,y, z, w)$ for the following system:\n\n$$\n\\begin{cases}\n&x&+ &2 y&+&2 z &+&2w &= 1\\\\\n&2x&+&4y&+&6z&+&8w &= 2\\\\\n&3x&+&6y&+&8z&+&10w &=3\n\\end{cases}\n$$\n\nUsing elimination algorithm we make linear combinations of the equation with the goal of eliminating variables, here is one way to go\\\n$$\n\\begin{align}\n&\\begin{pmatrix}\n1 & 2 & 2 & 2 &\\bigm|1\\\\\n2 & 4 & 6 & 8 &\\bigm|2\\\\\n3 & 6 & 8 & 10 &\\bigm| 3\n\\end{pmatrix}\n\\overset{l_2' = l_2-2l_1}{\\longrightarrow}\n\\begin{pmatrix}\n1 & 2 & 2 & 2 &\\bigm| 1\\\\\n0 & 0 & 2 & 4 &\\bigm| 0\\\\\n3 & 6 & 8 & 10 &\\bigm| 3\n\\end{pmatrix}\n\\overset{l_3' = l_3-3l_1}{\\longrightarrow}\n\\begin{pmatrix}\n1 & 2 & 2 & 2 &\\bigm| 1\\\\\n0 & 0 & 2 & 4 &\\bigm| 0\\\\\n0 & 0 & 2 & 4 &\\bigm| 0\n\\end{pmatrix}\\\\\n&\\overset{l_3'=l_3-l_2}{\\longrightarrow}\n\\begin{pmatrix}\n1 & 2 & 2 & 2 &\\bigm| 1\\\\\n0 & 0 & 2 & 4 &\\bigm| 0\\\\\n0 & 0 & 0 & 0 &\\bigm| 0\n\\end{pmatrix}\n\\overset{l_2'=1/2l_2}{\\longrightarrow}\n\\begin{pmatrix}\n1 & 2 & 2 & 2 &\\bigm| 1\\\\\n0 & 0 & 1 & 2 &\\bigm| 0\\\\\n0 & 0 & 0 & 0 &\\bigm| 0\n\\end{pmatrix}\n\\overset{l_1'=l_1-2l_2}{\\longrightarrow}\n\\begin{pmatrix}\n1 & 2 & 0 & -2 &\\bigm| 1\\\\\n0 & 0 & 1 & 2 &\\bigm| 0\\\\\n0 & 0 & 0 & 0 &\\bigm| 0\n\\end{pmatrix}\n\\end{align}\n$$ {#eq-example_4_system}\n\nWe simplified it as much as we can, going back to the system's notation we have:\n\n$$\n\\begin{cases}\nx + 2 y & &- &2w &=1\\\\\n&z &+ &2w &=0\n\\end{cases}\n$$\n\nNow, promote $y$ and $w$ into parameters and express $x$ and $z$ in term of them:\n\n$$\n\\begin{cases}\nx + 2 y & &- &2w &=1\\\\\n&z &+ &2w &=0\n\\end{cases}\n\\longrightarrow\n\\begin{cases}\nx &=1-2y&-&2w\\\\\nz &=&-&2w\n\\end{cases}\n$$ {#eq-sol_1}\n\nFor each values we assign to $y$ and $w$ we get one solution! There's an infinite number of them.\n\nThis example is given so that you can see, that the final aesthetic of the reduced $A'$ may have the $I$ and $F$ blocks mixed!\n\nThis is also a matrix with form:\n\n$$\n\\begin{pmatrix}I \\,\\,F\\end{pmatrix}\n$$\n\nThe rank is $r=2$, the rank of the extended matrix is $r^*=2$, meanwhile $n=4$. Since $r=r^*<n$ we have an infinite number of solutions.\n\n### Example 5: A system that may have one, none or many solutions\n\nWhat is the solution of:\n\n$$\n\\begin{cases}\n&x&+ &k y&+&2 z &= 1\\\\\n&x&+&y&+&(k+1)z &= k\\\\\n&-x&-&y&-&z &=k+1\n\\end{cases}\n$$\n\nUsing the extended matrix formulation we use the pivots to eliminate entries:\n\n$$ \\begin{align} &\\begin{pmatrix} 1 & k & 2  &\\bigm|1\\\\ 1 & 1 & k+1 &\\bigm|k\\\\ -1 & -1 & -1 &\\bigm| k+1 \\end{pmatrix} \\overset{l_2' = l_2-l_1\\\\l_3'=l_3+l_1}{\\longrightarrow} \\begin{pmatrix} 1 & k & 2 &\\bigm| 1\\\\ 0 & 1-k & k-1 &\\bigm| k-1\\\\ 0 & k-1 & 1 &\\bigm| k+2 \\end{pmatrix} \\overset{l_3' = l_3+l_2}{\\longrightarrow} \\begin{pmatrix} 1 & k & 2  &\\bigm| 1\\\\ 0 & 1-k & k-1 &\\bigm| k-1\\\\ 0 & 0 & k &\\bigm| 2k+1 \\end{pmatrix} \\end{align} $$\n\nNow, depending upon on the value $k$ the system may have one, none or many solutions:\n\n-   For $k=1$ then\n\n$$\n\\begin{pmatrix} 1 & 1 & 2  &\\bigm|1\\\\ 0 & 0 & 0 &\\bigm|0\\\\ 0 & 0 & 1 &\\bigm| 3 \\end{pmatrix} \\overset{l_2 \\leftrightarrow l_3}{\\longrightarrow} \\begin{pmatrix} 1 & 1 & 2  &\\bigm|1\\\\ 0 & 0 & 1 &\\bigm|3\\\\ 0 & 0 & 0 &\\bigm| 0 \\end{pmatrix}\\overset{l_1'=l_1-2l_2 }{\\longrightarrow}\\begin{pmatrix} 1 & 1 & 0  &\\bigm|-5\\\\ 0 & 0 & 1 &\\bigm|3\\\\ 0 & 0 & 0 &\\bigm| 0 \\end{pmatrix}\n$$ {#eq-k1}\n\nwhich has the form:\n\n$$\n\\begin{pmatrix}I\\,\\,F \\end{pmatrix}\n$$\n\nand: $r=2$, $r^*=2$ and $n=3$.\n\nSince $r=r^*<n$ we conclude we have an infinite number of solutions as we readily check by actually computing them. From @eq-k1 we know:\n\n$$\n\\begin{cases}\nx + y = -5\\\\\nz=3\n\\end{cases}\n$$\n\nSince we have two equations and three unknowns, we promote one of them, let it be $x$, to the status of a parameter $x_0$, hence:\n\n$$\n\\begin{pmatrix}x\\\\y\\\\z\\end{pmatrix}=\\begin{pmatrix}x_0\\\\-5-x_0\\\\3\\end{pmatrix}=\\begin{pmatrix}0\\\\-5\\\\3\\end{pmatrix}+x_0\\begin{pmatrix}1\\\\-1\\\\0\\end{pmatrix}\n$$\n\nFor each $x_0$ of our choice we have a distinct solution. There is infinite of them.\n\n-   For $k=0$\n\n$$\n\\begin{pmatrix} 1 & 0 & 2  &\\bigm|1\\\\ 0 & 1 & -1 &\\bigm|-1\\\\ 0 & 0 & 0 &\\bigm| 1 \\end{pmatrix} \n$$\n\nThe system has the form:\n\n$$\n\\begin{pmatrix}\nI & F\\\\\n\\mathbf{0} &\\mathbf{0}\n\\end{pmatrix}\n$$\n\nAnd note: $r=2$, $r^*=3$ and $n=3$, thus $r<r^*=n$ which tells us there is no solution. In fact we can see why by rolling back to:\n\n$$\n\\begin{cases}\nx+2z=1\\\\\ny-z =-1\\\\\n0=1\n\\end{cases}\n$$\n\nThere are no $x$, $y$ and $z$ that satisfies these three equations simultaneously.\n\n-   If $k$ is not $0,1$ then we always have $r=r^*=n$, thus, there is always a unique solution.\n\n**In summary:**\n\n-   *A system of equations* $A\\mathbf{x}=\\mathbf{b}$ *have infinite solutions provided* $r=r^*<n$.\n\n-   *A system of equations* $A\\mathbf{x}=\\mathbf{b}$ *have one solution provided* $r=r^*=n$.\n\n-   *A system of equations* $A\\mathbf{x}=\\mathbf{b}$ *have no solutions provided* $r<r^*$.\n\n::: callout-note\n## Commentaries\n\n-   For the moment assume this summary as a fact of life, later we'll justify in detail the meaning of this triple equality, for know just focus on learning elimination and testing the triple equality\n\n-   How do we know how many pivots are there? Use elimination method to introduce in the matrix as many zeros as possible, giving us the reduced form $A'$. Counting the pivots in $A'$ is easy. Recall that the number of pivots of $A$ is the same as $A'$.\n\n-   A matrix where all entries below the pivots were killed is in triangular form. Back substitution can already be used at this stage. (we did not do this in the examples, but we could) If we proceed and also kill all entries above the pivots, we get the best matrix (this is what we did in the examples above). A matrix is then said to be in *reduced row echelon form*. Back substitution can also used at this final stage.\n:::\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":false,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"output-file":"systems_of_equations.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.7.32","editor":"visual","comments":{"hypothesis":true},"preview":{"browser":"chrome"},"theme":{"light":"minty"},"fontcolor":"rgb(190,190,190)","backgroundcolor":"rgb(32,31,30)","margin-left":"rgb(32,31,30)","navbar-color":"rgba(216, 6, 33 .65)","title":"Systems of equations"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}